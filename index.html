<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>جامعة الأقصى للعلوم والتكنولوجيا</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root { --gold: #c59d3f; --dark: #1a1a1a; --grey: #f4f7f6; }
        body { margin: 0; font-family: 'Cairo', sans-serif; background: #fff; }
        header { background: #fff; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .hero { height: 350px; background-color: #444; background-size: cover; background-position: center; display: flex; align-items: center; justify-content: center; color: white; position: relative; }
        .hero::after { content: ""; position: absolute; inset: 0; background: rgba(0,0,0,0.5); }
        .hero h1 { z-index: 2; font-size: 2rem; text-align: center; margin: 0; }
        .container { max-width: 900px; margin: auto; padding: 20px; }
        .card { background: var(--grey); padding: 20px; border-radius: 12px; margin-bottom: 20px; border-right: 5px solid var(--gold); }
        #adminArea { display: none; background: #fff; position: fixed; inset: 0; z-index: 1000; overflow-y: auto; padding: 20px; }
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; font-family: 'Cairo'; box-sizing: border-box; }
        .btn { background: var(--gold); color: white; border: none; padding: 15px; border-radius: 8px; width: 100%; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

    <header>
        <strong>جامعة الأقصى</strong>
        <span onclick="openAdmin()" style="cursor:pointer; font-size: 1.5rem;">⚙️</span>
    </header>

    <div class="hero" id="heroBg" style="background-image: url('https://images.unsplash.com/photo-1541339907198-e08756ebafe3?w=1000');">
        <h1 id="displayTitle">جامعة الأقصى للعلوم والتكنولوجيا</h1>
    </div>

    <div class="container">
        <div class="card">
            <h3>الرؤية والرسالة</h3>
            <p id="displayVision">الريادة في التعليم العالي والبحث العلمي لبناء مجتمع المعرفة وتلبية احتياجات التنمية المستدامة.</p>
        </div>

        <div class="card">
            <h3>رئاسة الجامعة</h3>
            <p><strong>المؤسس:</strong> <span id="displayFounder">الأستاذ عادل علي مساعد</span></p>
            <p><strong>رئيس الجامعة:</strong> <span id="displayPresident">الدكتور حمود القديمي</span></p>
        </div>

        <h2 style="border-right: 5px solid var(--gold); padding-right: 10px;">آخر الأخبار</h2>
        <div id="newsList">
            <p style="color:#888;">لا توجد أخبار منشورة حالياً.</p>
        </div>
    </div>

    <div id="adminArea">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2>إدارة المحتوى</h2>
            <button onclick="closeAdmin()" style="background:red; color:white; border:none; padding:5px 15px; border-radius:5px;">إغلاق</button>
        </div>
        <hr>
        <label>عنوان الموقع الرئيسي:</label>
        <input type="text" id="editTitle">
        <label>نص الرؤية:</label>
        <textarea id="editVision" rows="4"></textarea>
        <label>صورة الغلاف (رفع مباشر):</label>
        <input type="file" id="fileHero" accept="image/*">
        <button class="btn" onclick="saveData()">حفظ التعديلات</button>
        
        <hr>
        <h3>نشر خبر جديد</h3>
        <input type="text" id="newsTitle" placeholder="عنوان الخبر">
        <textarea id="newsDesc" placeholder="تفاصيل الخبر"></textarea>
        <input type="file" id="fileNews" accept="image/*">
        <button class="btn" style="background:#27ae60" onclick="postNews()">نشر الخبر</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCymqlC7QfKyS_XY73zjHkDW-IK3KcBCxI",
            databaseURL: "https://alaqsa-university-6c2ad-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // تحميل البيانات من Firebase إذا وجدت
        db.ref('siteData').on('value', (snap) => {
            const data = snap.val();
            if(data) {
                if(data.title) {
                    document.getElementById('displayTitle').innerText = data.title;
                    document.getElementById('editTitle').value = data.title;
                }
                if(data.vision) {
                    document.getElementById('displayVision').innerText = data.vision;
                    document.getElementById('editVision').value = data.vision;
                }
                if(data.hero) document.getElementById('heroBg').style.backgroundImage = `url('${data.hero}')`;
            }
        });

        // جلب الأخبار
        db.ref('news').on('value', (snap) => {
            let html = "";
            snap.forEach(child => {
                const n = child.val();
                html += `<div class="card"><img src="${n.img}" style="width:100%; border-radius:8px;"><h3>${n.title}</h3><p>${n.desc}</p></div>`;
            });
            if(html) document.getElementById('newsList').innerHTML = html;
        });

        function openAdmin() { if(prompt("كلمة المرور:") === "sayhi1322") document.getElementById('adminArea').style.display='block'; }
        function closeAdmin() { document.getElementById('adminArea').style.display='none'; }

        async function uploadImg(file) {
            const fd = new FormData(); fd.append("image", file);
            const res = await fetch("https://api.imgbb.com/1/upload?key=6d84033e9d80c05a6396b27e4e08611a", {method:"POST", body:fd});
            const j = await res.json(); return j.data.url;
        }

        async function saveData() {
            const title = document.getElementById('editTitle').value;
            const vision = document.getElementById('editVision').value;
            const file = document.getElementById('fileHero').files[0];
            let url = null;
            if(file) url = await uploadImg(file);
            
            db.ref('siteData').update({
                title: title,
                vision: vision,
                ...(url && {hero: url})
            });
            alert("تم التحديث!");
        }

        async function postNews() {
            const title = document.getElementById('newsTitle').value;
            const desc = document.getElementById('newsDesc').value;
            const file = document.getElementById('fileNews').files[0];
            if(!file) return alert("اختر صورة للخبر");
            const img = await uploadImg(file);
            db.ref('news').push({ title, desc, img });
            alert("تم النشر!");
        }
    </script>
</body>
</html>
